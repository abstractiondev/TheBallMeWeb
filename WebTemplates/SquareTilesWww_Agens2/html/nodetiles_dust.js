(function(){dust.register("nodetiles.dust",body_0);function body_0(chk,ctx){return chk.write("<div class=\"text-center\" id=\"isotope_content_row\"><div class=\"filter-box\"><!--<div class=\"isotope-sort categories\"><a href=\"#\" class=\"isotope-sort-filter filter button\" data-filter-value=\".ROOTCATEGORY\"><i class=\"icon-home\"></i></a>").section(ctx.get("RootCategories"),ctx,{"block":body_1},null).write("</div>--></div><div id=\"tilecontainer\">").section(ctx.get("Nodes"),ctx,{"block":body_2},null).write("</div></div><script>var applyIndexStyleClasses = function() {var $nodetiles = $(\".nodetile\").not(\".isotope-hidden\").sort(function(elem1, elem2) {var $e1 = $(elem1);var $e2 = $(elem2);var pos1 = $e1.data(\"isotope-item-position\");var pos2 = $e2.data(\"isotope-item-position\");var val1 = pos1.x;var val2 = pos2.x;if(val1 == val2)return 0;return val1 < val2 ? -1 : 1;}).sort(function(elem1, elem2) {var $e1 = $(elem1);var $e2 = $(elem2);var pos1 = $e1.data(\"isotope-item-position\");var pos2 = $e2.data(\"isotope-item-position\");var val1 = pos1.y;var val2 = pos2.y;if(val1 == val2)return 0;return val1 < val2 ? -1 : 1;});console.log(\"Styling total tiles: \" + $nodetiles.length);var currIX = 0;$nodetiles.each(function(ix, elem) {var $elem = $(elem);/*var position = $elem.data(\"isotope-item-position\");var xIndex = parseInt(position.x / $elem.width());var yIndex = parseInt(position.y / $elem.height());var posIX = xIndex + yIndex;console.log(\"X: \" + xIndex + \" Y: \" + yIndex + \" Posix: \" + posIX);currIX = posIX % 4;*/console.log(\"CurrIX: \" + currIX);var className = \"styleix\" + currIX;$elem.addClass(className);currIX = (currIX + 1) % 4;});};$(function(){var $container = $('#tilecontainer');var filters = {};$container.isotope({itemSelector : '.nodetile',filter: '.ROOTCATEGORY',itemPositionDataEnabled: true,getSortData: {rankFunc: function($item) {var title = $item.data(\"title\");if(!CurrentCategoryID)return title;var rankObjects = CategoryContentMap[CurrentCategoryID];var myIndex = _.findIndex(rankObjects, function(rItem) {return rItem.Title == title;});return myIndex;}}});var loaded = 0;var numImages = $(\"img\").length;$(\"img\").load(function() {++loaded;if (loaded === numImages) {$container.isotope('reLayout');}});applyIndexStyleClasses();/* filter buttons */$('a.filter').click(function(){var $this = $(this);var categoryID = $this.data(\"categoryid\");CurrentCategoryID = categoryID;/* don't proceed if already selected */if ( $this.hasClass('selected') ) {console.log(\"Already selected, skipping...\");return false;}/*alert(\"FILTERING!\");*/var $optionSet = $this.parents('.isotope-sort');/* change selected class */$optionSet.find('.selected').removeClass('selected');$(\".contentfilter-selected\").removeClass(\"selected\").removeClass(\".contentfilter-selected\");$this.addClass('selected');$this.addClass(\"contentfilter-selected\");var filterValue = $this.attr(\"data-filter-value\");console.log(\"Applying filter selector: \" + filterValue);$container.isotope({ filter: filterValue });if(CurrentCategoryID) {$container.isotope('updateSortData', $(\".nodetile\"));$container.isotope({ sortBy: \"rankFunc\" });updateMainLogo(CurrentCategoryID);} else {$container.isotope({ sortBy: \"original-order\"});}applyIndexStyleClasses();return false;});if(navigator.appName != 'Microsoft Internet Explorer'){$container.imagesLoaded( function() {$container.isotope({filter : '.ROOTCATEGORY'});});}});$(function() {$(\"#TileDefaultFilter\").trigger('click');var getOIParticleUrl = function (type, id) {var prefix;var suffix = \"_DefaultView.phtml\";switch (type) {case \"textcontent\":return \"../../AaltoGlobalImpact.OIP/TextContent/\" + id + \".json\";case \"news\":prefix = \"AaltoGlobalImpact.OIP.Blog_\";break;case \"activity\":prefix = \"AaltoGlobalImpact.OIP.Activity_\";break;}return prefix + id + suffix;};var getURLParameter = function (name) {return decodeURIComponent((new RegExp('[?|&]' + name + '=' + '([^&;]+?)(&|#|;|$)').exec(location.search) || [, \"\"])[1].replace(/\\+/g, '%20')) || null;};var typePar = getURLParameter(\"type\");var idPar = getURLParameter(\"id\");if (typePar != null && idPar != null) {var oipArticleUrl = getOIParticleUrl(typePar, idPar);OipOpenArticle(oipArticleUrl);window.history.pushState(\"string\", \"Schools The Ball\", \"index.html\");}});</script>");}function body_1(chk,ctx){return chk.write("<a href=\"#\"  class=\"isotope-sort-filter filter button\"data-categoryid=\"").reference(ctx.get("ID"),ctx,"h").write("\" data-filter-value=\".cat").reference(ctx.get("ID"),ctx,"h").write("\">").reference(ctx.get("Title"),ctx,"h").write("</a>");}function body_2(chk,ctx){return chk.write("<div class=\"\"><!-- three_col four_col two_col -->").section(ctx.get("CollectionContent"),ctx,{"block":body_3},null).write("</div>");}function body_3(chk,ctx){return chk.write("<div data-title=\"").reference(ctx.get("Title"),ctx,"h").write("\" class=\"nodetile ").exists(ctx.get("Categories"),ctx,{"else":body_4,"block":body_5},null).write(" \">").exists(ctx.get("ImageBaseUrl"),ctx,{"else":body_7,"block":body_9},null).write("<div class=\"entry-summary\"><h4>").exists(ctx.get("IsCategoryFilteringNode"),ctx,{"else":body_16,"block":body_21},null).write("</h4><div class=\"excerpt\">").reference(ctx.get("ExcerptRendered"),ctx,"h",["s"]).write("</div>").exists(ctx.get("IsCategoryFilteringNode"),ctx,{"else":body_22,"block":body_25},null).write("</div></div>");}function body_4(chk,ctx){return chk.write("ROOTCATEGORY");}function body_5(chk,ctx){return chk.section(ctx.get("Categories"),ctx,{"block":body_6},null);}function body_6(chk,ctx){return chk.write("cat").reference(ctx.get("ID"),ctx,"h").write(" ").reference(ctx.get("CategoryName"),ctx,"h").write(" ");}function body_7(chk,ctx){return chk.helper("eq",ctx,{"block":body_8},{"key":ctx.get("TechnicalSource"),"value":"EMBEDDEDCONTENT"});}function body_8(chk,ctx){return chk.write("<a style=\"max-height: 150px\" href=\"#\" class=\"oipclicktoview\" data-original-content-id=\"").reference(ctx.get("OriginalContentID"),ctx,"h").write("\"><iframe style=\"width: 100%;height: 100%\" ").reference(ctx.get("ActualContentUrl"),ctx,"h",["s"]).write("></iframe></a>");}function body_9(chk,ctx){return chk.write("<div class=\"tileimagecontainer\">").exists(ctx.get("IsCategoryFilteringNode"),ctx,{"else":body_10,"block":body_15},null).write("</div>");}function body_10(chk,ctx){return chk.helper("eq",ctx,{"else":body_11,"block":body_14},{"key":ctx.get("TechnicalSource"),"value":"LINKTOCONTENT"});}function body_11(chk,ctx){return chk.helper("eq",ctx,{"else":body_12,"block":body_13},{"key":ctx.get("TechnicalSource"),"value":"IMAGE"});}function body_12(chk,ctx){return chk.write("<a class=\"hover oipclicktoview\" href=\"#\" data-original-content-id=\"").reference(ctx.get("OriginalContentID"),ctx,"h").write("\"><img class=\"tileimage\" src=\"").reference(ctx.get("ImageBaseUrl"),ctx,"h").write("_320x240_crop").reference(ctx.get("ImageExt"),ctx,"h").write("\" alt=\"\" /><span class=\"plus\"></span></a>");}function body_13(chk,ctx){return chk.write("<img class=\"tileimage\" src=\"").reference(ctx.get("ImageBaseUrl"),ctx,"h").write("_320x240_crop").reference(ctx.get("ImageExt"),ctx,"h").write("\" alt=\"\" /><span class=\"plus\"></span>");}function body_14(chk,ctx){return chk.write("<a class=\"hover\" href=\"").reference(ctx.get("ActualContentUrl"),ctx,"h").write("\"><img class=\"tileimage\" src=\"").reference(ctx.get("ImageBaseUrl"),ctx,"h").write("_320x240_crop").reference(ctx.get("ImageExt"),ctx,"h").write("\" alt=\"\" /><span class=\"plus\"></span></a>");}function body_15(chk,ctx){return chk.write("<a class=\"hover filter\" href=\"#\" data-filter-value=\".cat").reference(ctx.get("OriginalContentID"),ctx,"h").write("\" data-categoryid=\"").reference(ctx.get("OriginalContentID"),ctx,"h").write("\"><img class=\"tileimage\" src=\"").reference(ctx.get("ImageBaseUrl"),ctx,"h").write("_320x240_crop").reference(ctx.get("ImageExt"),ctx,"h").write("\" alt=\"\" /><span class=\"plus\"></span></a>");}function body_16(chk,ctx){return chk.helper("eq",ctx,{"else":body_17,"block":body_20},{"key":ctx.get("TechnicalSource"),"value":"LINKTOCONTENT"});}function body_17(chk,ctx){return chk.helper("eq",ctx,{"else":body_18,"block":body_19},{"key":ctx.get("TechnicalSource"),"value":"IMAGE"});}function body_18(chk,ctx){return chk.write("<a class=\"oipclicktoview stylelink\" href=\"#\" data-original-content-id=\"").reference(ctx.get("OriginalContentID"),ctx,"h").write("\">").reference(ctx.get("Title"),ctx,"h").write("</a>");}function body_19(chk,ctx){return chk.write("<div>").reference(ctx.get("Title"),ctx,"h").write("</div>");}function body_20(chk,ctx){return chk.write("<a href=\"").reference(ctx.get("ActualContentUrl"),ctx,"h").write("\">").reference(ctx.get("Title"),ctx,"h").write("</a>");}function body_21(chk,ctx){return chk.write("<a class=\"filter button filter\" href=\"#\"data-filter-value=\".cat").reference(ctx.get("OriginalContentID"),ctx,"h").write("\" data-categoryid=\"").reference(ctx.get("OriginalContentID"),ctx,"h").write("\">").reference(ctx.get("Title"),ctx,"h").write("</a>");}function body_22(chk,ctx){return chk.write("<a class=\"pricetag oipclicktoview button\" href=\"#\" data-original-content-id=\"").reference(ctx.get("OriginalContentID"),ctx,"h").write("\">").section(ctx.get("Authors"),ctx,{"block":body_23},null).write("</a>");}function body_23(chk,ctx){return chk.section(ctx.get("CollectionContent"),ctx,{"block":body_24},null);}function body_24(chk,ctx){return chk.reference(ctx.get("Content"),ctx,"h");}function body_25(chk,ctx){return chk;}return body_0;})();